<!-- /templates/dashboard.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tastytrade Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header>
        <div class="container">
            <h1>Tastytrade Dashboard</h1>
        </div>
    </header>

    <div class="container">
        <button id="refresh-button" class="refresh-button">Refresh Data</button>
        
        <div class="dashboard-section">
            <div class="card">
                <h2>MSTU Stock</h2>
                <div id="mstu-loading">Loading MSTU data...</div>
                <div id="mstu-error" class="error-message hidden"></div>
                <div id="mstu-data" class="hidden">
                    <div class="data-row">
                        <span class="data-label">Symbol:</span>
                        <span id="mstu-symbol">MSTU</span>
                    </div>
                    <div class="data-row">
                        <span class="data-label">Description:</span>
                        <span id="mstu-description">Microstrategy Inc</span>
                    </div>
                    <div class="data-row">
                        <span class="data-label">Last Price:</span>
                        <span id="mstu-last-price">$0.00</span>
                    </div>
                    <div class="data-row">
                        <span class="data-label">Bid Price:</span>
                        <span id="mstu-bid-price">$0.00</span>
                    </div>
                    <div class="data-row">
                        <span class="data-label">Ask Price:</span>
                        <span id="mstu-ask-price">$0.00</span>
                    </div>
                    <div class="data-row">
                        <span class="data-label">Change:</span>
                        <span id="mstu-change">$0.00</span>
                    </div>
                    <div class="data-row">
                        <span class="data-label">% Change:</span>
                        <span id="mstu-percent-change">0.00%</span>
                    </div>
                    <div class="timestamp">
                        Last updated: <span id="mstu-timestamp">Unknown</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="dashboard-section">
            <div class="card">
                <h2>Account Balance</h2>
                <div id="account-loading">Loading account data...</div>
                <div id="account-error" class="error-message hidden"></div>
                <div id="account-data" class="hidden">
                    <div class="data-row">
                        <span class="data-label">Cash Balance:</span>
                        <span id="cash-balance">$0.00</span>
                    </div>
                    <div class="data-row">
                        <span class="data-label">Total Equity:</span>
                        <span id="total-equity">$0.00</span>
                    </div>
                    <div class="data-row">
                        <span class="data-label">Buying Power:</span>
                        <span id="buying-power">$0.00</span>
                    </div>
                    <div class="timestamp">
                        Last updated: <span id="account-timestamp">Unknown</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="dashboard-section">
            <div class="card">
                <h2>Buy MSTU</h2>
                <form id="buy-form" class="buy-form">
                    <div class="form-group">
                        <label for="quantity">Quantity:</label>
                        <input type="number" id="quantity" name="quantity" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="order-type">Order Type:</label>
                        <select id="order-type" name="order_type">
                            <option value="Market">Market</option>
                            <option value="Limit">Limit</option>
                        </select>
                    </div>
                    <div class="form-group" id="price-group" style="display: none;">
                        <label for="price">Limit Price:</label>
                        <input type="number" id="price" name="price" step="0.01" min="0.01">
                    </div>
                    <div id="buy-error" class="error-message hidden"></div>
                    <div id="buy-success" class="success-message hidden"></div>
                    <button type="submit">Buy MSTU</button>
                </form>
            </div>
        </div>

        <div class="dashboard-section">
            <div class="card">
                <h2>API Calls History</h2>
                <div id="api-calls-loading">Loading API call history...</div>
                <div id="api-calls-data" class="hidden">
                    <table class="api-calls-table">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Endpoint</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="api-calls-tbody">
                            <!-- API calls will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get DOM elements
            const refreshButton = document.getElementById('refresh-button');
            const orderTypeSelect = document.getElementById('order-type');
            const priceGroup = document.getElementById('price-group');
            const buyForm = document.getElementById('buy-form');
